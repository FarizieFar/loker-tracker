<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loker Tracker - Aplikasi Manajemen Lamaran Kerja Modern</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
</head>
<body>

<!-- Modern Header -->
<header class="header">
    <div class="container">
        <div class="header-content">
            <a href="{{ url_for('index') }}" class="brand">
                <i class="fas fa-briefcase me-2"></i>
                Loker Tracker
            </a>
            {% if current_user.is_authenticated %}

            <div class="d-flex align-items-center gap-4">
                <!-- AI Features Navigation -->
                <div class="d-flex align-items-center gap-3">
                    <a href="{{ url_for('ai_dashboard') }}" class="btn btn-outline-primary btn-sm" title="AI Dashboard">
                        <i class="fas fa-robot me-1"></i>
                        <span class="d-none d-md-inline">AI</span>
                    </a>
                    <a href="{{ url_for('upload_cv') }}" class="btn btn-outline-info btn-sm" title="Upload CV">
                        <i class="fas fa-upload me-1"></i>
                        <span class="d-none d-md-inline">CV</span>
                    </a>
                </div>
                
                <div style="display: flex; align-items: center; gap: var(--space-3);">
                    <div style="width: 32px; height: 32px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 0.875rem;">
                        {{ current_user.username[0].upper() }}
                    </div>
                    <span style="color: var(--text-secondary); font-size: 0.875rem; font-weight: 500;">Welcome, {{ current_user.username }}</span>
                </div>
                <a href="{{ url_for('logout') }}" class="btn btn-secondary btn-sm">
                    <i class="fas fa-sign-out-alt me-2"></i>
                    Logout
                </a>
            </div>
            {% endif %}
        </div>
    </div>
</header>

<!-- Main Content -->
<main class="main-container">
    <div class="container">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div style="margin-bottom: var(--space-6);">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ 'danger' if category == 'error' else category }}" style="margin-bottom: var(--space-3);">
                            <i class="fas fa-{{ 'exclamation-triangle' if category == 'error' else 'check-circle' if category == 'success' else 'info-circle' }} me-2"></i>
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
        
        {% block content %}{% endblock %}
    </div>
</main>

<!-- Modern Footer -->
<footer style="background: var(--bg-primary); border-top: 1px solid var(--gray-200); padding: var(--space-12) 0; margin-top: var(--space-20);">
    <div class="container">
        <div class="text-center">
            <div class="brand mb-3" style="font-size: 1.5rem;">
                <i class="fas fa-briefcase me-2"></i>
                Loker Tracker
            </div>
            <p style="color: var(--text-secondary); margin-bottom: var(--space-4); max-width: 500px; margin-left: auto; margin-right: auto;">
                Aplikasi manajemen lamaran kerja yang modern, efisien, dan user-friendly untuk membantu Anda melacak progress karirer dengan mudah.
            </p>
            <div style="color: var(--text-muted); font-size: 0.875rem;">
                © 2024 Loker Tracker. Dibuat dengan ❤️ untuk kemajuan karirer Anda.
            </div>
        </div>
    </div>
</footer>

<!-- Modern Image Modal -->
<div id="imageModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.8); z-index: 1000; backdrop-filter: blur(4px);">
    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 90%; max-height: 90%; background: var(--bg-primary); padding: var(--space-6); border-radius: var(--radius-xl); box-shadow: var(--shadow-xl); border: 1px solid var(--gray-200);">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-6);">
            <h3 id="modalTitle" style="margin: 0; color: var(--text-primary); font-weight: 600;"></h3>
            <button onclick="closeImageModal()" 
                    style="background: var(--gray-100); border: none; width: 36px; height: 36px; border-radius: var(--radius-md); cursor: pointer; color: var(--text-secondary); display: flex; align-items: center; justify-content: center; transition: all var(--transition-normal);">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <img id="modalImage" src="" alt="Preview" style="max-width: 100%; height: auto; border-radius: var(--radius-md); box-shadow: var(--shadow-sm);">
    </div>
</div>

<!-- Modern Alert System -->
<div id="alertContainer" style="position: fixed; top: var(--space-6); right: var(--space-6); z-index: 1100; display: flex; flex-direction: column; gap: var(--space-3);">
    <!-- Alerts will be inserted here dynamically -->
</div>

<script>
// Modern Alert System
function showAlert(message, type = 'info', duration = 4000) {
    const container = document.getElementById('alertContainer');
    
    const alertDiv = document.createElement('div');
    alertDiv.className = 'alert alert-' + type;
    alertDiv.style.cssText = `
        min-width: 320px;
        max-width: 400px;
        padding: var(--space-4) var(--space-6);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-lg);
        display: flex;
        align-items: center;
        gap: var(--space-3);
        transform: translateX(100%);
        transition: all var(--transition-normal);
        border: 1px solid;
        background: var(--bg-primary);
        animation: slideIn 0.3s ease-out;
    `;
    
    const iconMap = {
        'success': { icon: 'check-circle', color: 'var(--success)' },
        'error': { icon: 'exclamation-triangle', color: 'var(--danger)' },
        'warning': { icon: 'exclamation-circle', color: 'var(--warning)' },
        'info': { icon: 'info-circle', color: 'var(--primary)' }
    };
    
    const config = iconMap[type] || iconMap.info;
    
    alertDiv.innerHTML = `
        <i class="fas fa-${config.icon}" style="color: ${config.color}; font-size: 1.125rem;"></i>
        <span style="font-weight: 500; color: var(--text-primary);">${message}</span>
        <button onclick="this.parentElement.remove()" 
                style="background: none; border: none; margin-left: auto; color: var(--text-muted); cursor: pointer; padding: var(--space-1);">
            <i class="fas fa-times"></i>
        </button>
    `;
    
    // Set border color based on type
    const borderColors = {
        'success': 'var(--success)',
        'error': 'var(--danger)',
        'warning': 'var(--warning)',
        'info': 'var(--primary)'
    };
    alertDiv.style.borderColor = borderColors[type] || borderColors.info;
    
    container.appendChild(alertDiv);
    
    // Animate in
    setTimeout(() => {
        alertDiv.style.transform = 'translateX(0)';
    }, 10);
    
    // Auto remove
    if (duration > 0) {
        setTimeout(() => {
            alertDiv.style.transform = 'translateX(100%)';
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 300);
        }, duration);
    }
}

// Modern Image Modal functions
function showImageModal(imageSrc, title = 'Preview Bukti Lamaran') {
    const modal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');
    const modalTitle = document.getElementById('modalTitle');
    
    modalImage.src = imageSrc;
    modalTitle.textContent = title;
    modal.style.display = 'block';
    
    // Fade in animation
    modal.style.opacity = '0';
    setTimeout(() => {
        modal.style.transition = 'opacity 0.3s ease';
        modal.style.opacity = '1';
    }, 10);
}

function closeImageModal() {
    const modal = document.getElementById('imageModal');
    modal.style.opacity = '0';
    setTimeout(() => {
        modal.style.display = 'none';
    }, 300);
}

// Global functions
window.showAlert = showAlert;
window.showImageModal = showImageModal;
window.closeImageModal = closeImageModal;

// Close modal when clicking outside
window.addEventListener('click', function(event) {
    const modal = document.getElementById('imageModal');
    if (event.target === modal) {
        closeImageModal();
    }
});

// Close modal with Escape key
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        closeImageModal();
    }
});

// Add loading states to all forms
document.addEventListener('DOMContentLoaded', function() {
    const forms = document.querySelectorAll('form');
    forms.forEach(form => {
        form.addEventListener('submit', function(e) {
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn && !submitBtn.disabled) {
                const originalContent = submitBtn.innerHTML;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Memproses...';
                submitBtn.disabled = true;
                
                // Re-enable after 5 seconds as fallback
                setTimeout(() => {
                    submitBtn.innerHTML = originalContent;
                    submitBtn.disabled = false;
                }, 5000);
            }
        });
    });
    
    // Add smooth scrolling to anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
});

// CSS Animations
const style = document.createElement('style');
style.textContent = `
    @keyframes slideIn {
        from { 
            transform: translateX(100%); 
            opacity: 0; 
        }
        to { 
            transform: translateX(0); 
            opacity: 1; 
        }
    }
    
    .alert:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-xl);
    }
`;
document.head.appendChild(style);
</script>

</body>
</html>

